"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/proxy/opensky";
exports.ids = ["pages/api/proxy/opensky"];
exports.modules = {

/***/ "(api-node)/./config/api.ts":
/*!***********************!*\
  !*** ./config/api.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   API_CONFIG: () => (/* binding */ API_CONFIG)\n/* harmony export */ });\n// config/api.ts\nconst API_CONFIG = {\n    BASE_URL: 'https://opensky-network.org/api',\n    WS_URL: 'wss://opensky-network.org/api/ws',\n    ENDPOINTS: {\n        ALL_STATES: '/states/all',\n        WEBSOCKET: '/websocket'\n    },\n    HEADERS: {\n        ACCEPT: 'application/json',\n        CONTENT_TYPE: 'application/json'\n    },\n    TIMEOUT: {\n        DEFAULT: 10000,\n        WEBSOCKET: 30000,\n        LONG_POLL: 60000\n    },\n    PARAMS: {\n        ICAO24: 'ICAO24',\n        TIME: 'time',\n        EXTENDED: 'extended',\n        MAX_ICAO_QUERY: 200,\n        MAX_TOTAL_ICAO_QUERY: 2000\n    },\n    API: {\n        MIN_POLLING_INTERVAL: 300000,\n        MAX_POLLING_INTERVAL: 600000,\n        TIMEOUT_MS: 15000,\n        DEFAULT_RETRY_LIMIT: 3,\n        MAX_RETRY_LIMIT: 5\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL2NvbmZpZy9hcGkudHMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGdCQUFnQjtBQUNULE1BQU1BLGFBQWE7SUFDeEJDLFVBQVU7SUFDVkMsUUFBUTtJQUNSQyxXQUFXO1FBQ1RDLFlBQVk7UUFDWkMsV0FBVztJQUNiO0lBQ0FDLFNBQVM7UUFDUEMsUUFBUTtRQUNSQyxjQUFjO0lBQ2hCO0lBQ0FDLFNBQVM7UUFDUEMsU0FBUztRQUNUTCxXQUFXO1FBQ1hNLFdBQVc7SUFDYjtJQUNBQyxRQUFRO1FBQ05DLFFBQVE7UUFDUkMsTUFBTTtRQUNOQyxVQUFVO1FBQ1ZDLGdCQUFnQjtRQUNoQkMsc0JBQXNCO0lBQ3hCO0lBRUFDLEtBQUs7UUFDSEMsc0JBQXNCO1FBQ3RCQyxzQkFBc0I7UUFDdEJDLFlBQVk7UUFDWkMscUJBQXFCO1FBQ3JCQyxpQkFBaUI7SUFDbkI7QUFDRixFQUFXIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXHNhdGhvXFxEb2N1bWVudHNcXFByb2plY3RzXFxhaXJjcmFmdC10cmFja2luZ1xcY29uZmlnXFxhcGkudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gY29uZmlnL2FwaS50c1xyXG5leHBvcnQgY29uc3QgQVBJX0NPTkZJRyA9IHtcclxuICBCQVNFX1VSTDogJ2h0dHBzOi8vb3BlbnNreS1uZXR3b3JrLm9yZy9hcGknLFxyXG4gIFdTX1VSTDogJ3dzczovL29wZW5za3ktbmV0d29yay5vcmcvYXBpL3dzJyxcclxuICBFTkRQT0lOVFM6IHtcclxuICAgIEFMTF9TVEFURVM6ICcvc3RhdGVzL2FsbCcsXHJcbiAgICBXRUJTT0NLRVQ6ICcvd2Vic29ja2V0JyxcclxuICB9LFxyXG4gIEhFQURFUlM6IHtcclxuICAgIEFDQ0VQVDogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgQ09OVEVOVF9UWVBFOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgfSxcclxuICBUSU1FT1VUOiB7XHJcbiAgICBERUZBVUxUOiAxMDAwMCxcclxuICAgIFdFQlNPQ0tFVDogMzAwMDAsXHJcbiAgICBMT05HX1BPTEw6IDYwMDAwLFxyXG4gIH0sXHJcbiAgUEFSQU1TOiB7XHJcbiAgICBJQ0FPMjQ6ICdJQ0FPMjQnLFxyXG4gICAgVElNRTogJ3RpbWUnLFxyXG4gICAgRVhURU5ERUQ6ICdleHRlbmRlZCcsXHJcbiAgICBNQVhfSUNBT19RVUVSWTogMjAwLFxyXG4gICAgTUFYX1RPVEFMX0lDQU9fUVVFUlk6IDIwMDAsXHJcbiAgfSxcclxuXHJcbiAgQVBJOiB7XHJcbiAgICBNSU5fUE9MTElOR19JTlRFUlZBTDogMzAwMDAwLFxyXG4gICAgTUFYX1BPTExJTkdfSU5URVJWQUw6IDYwMDAwMCxcclxuICAgIFRJTUVPVVRfTVM6IDE1MDAwLFxyXG4gICAgREVGQVVMVF9SRVRSWV9MSU1JVDogMyxcclxuICAgIE1BWF9SRVRSWV9MSU1JVDogNSxcclxuICB9LFxyXG59IGFzIGNvbnN0O1xyXG4iXSwibmFtZXMiOlsiQVBJX0NPTkZJRyIsIkJBU0VfVVJMIiwiV1NfVVJMIiwiRU5EUE9JTlRTIiwiQUxMX1NUQVRFUyIsIldFQlNPQ0tFVCIsIkhFQURFUlMiLCJBQ0NFUFQiLCJDT05URU5UX1RZUEUiLCJUSU1FT1VUIiwiREVGQVVMVCIsIkxPTkdfUE9MTCIsIlBBUkFNUyIsIklDQU8yNCIsIlRJTUUiLCJFWFRFTkRFRCIsIk1BWF9JQ0FPX1FVRVJZIiwiTUFYX1RPVEFMX0lDQU9fUVVFUlkiLCJBUEkiLCJNSU5fUE9MTElOR19JTlRFUlZBTCIsIk1BWF9QT0xMSU5HX0lOVEVSVkFMIiwiVElNRU9VVF9NUyIsIkRFRkFVTFRfUkVUUllfTElNSVQiLCJNQVhfUkVUUllfTElNSVQiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api-node)/./config/api.ts\n");

/***/ }),

/***/ "(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproxy%2Fopensky&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproxy%5Copensky.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproxy%2Fopensky&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproxy%5Copensky.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/pages-api/module.compiled */ \"(api-node)/./node_modules/next/dist/server/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(api-node)/./node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api-node)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_proxy_opensky_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\proxy\\opensky.ts */ \"(api-node)/./pages/api/proxy/opensky.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_proxy_opensky_ts__WEBPACK_IMPORTED_MODULE_3__, 'default'));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_proxy_opensky_ts__WEBPACK_IMPORTED_MODULE_3__, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/proxy/opensky\",\n        pathname: \"/api/proxy/opensky\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland: _pages_api_proxy_opensky_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaS1ub2RlKS8uL25vZGVfbW9kdWxlcy9uZXh0L2Rpc3QvYnVpbGQvd2VicGFjay9sb2FkZXJzL25leHQtcm91dGUtbG9hZGVyL2luZGV4LmpzP2tpbmQ9UEFHRVNfQVBJJnBhZ2U9JTJGYXBpJTJGcHJveHklMkZvcGVuc2t5JnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlNUNhcGklNUNwcm94eSU1Q29wZW5za3kudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ0U7QUFDMUQ7QUFDNEQ7QUFDNUQ7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHdEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx3REFBUTtBQUNwQztBQUNPLHdCQUF3Qix5R0FBbUI7QUFDbEQ7QUFDQSxjQUFjLGtFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxwcm94eVxcXFxvcGVuc2t5LnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsICdkZWZhdWx0Jyk7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCAnY29uZmlnJyk7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9wcm94eS9vcGVuc2t5XCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvcHJveHkvb3BlbnNreVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6ICcnLFxuICAgICAgICBmaWxlbmFtZTogJydcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproxy%2Fopensky&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproxy%5Copensky.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api-node)/./pages/api/proxy/opensky.ts":
/*!************************************!*\
  !*** ./pages/api/proxy/opensky.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _config_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/config/api */ \"(api-node)/./config/api.ts\");\n// pages/api/proxy/opensky.ts\n\n// Constants\nconst MAX_ICAOS_PER_REQUEST = 100; // OpenSky limit\nconst CACHE_TTL = 60000; // 1 minute cache\nconst MAX_REQUESTS_PER_MIN = 15; // Rate limit\nconst MAX_REQUESTS_PER_DAY = 1000; // Daily limit\n// Rate limiting state\nlet requestsThisMinute = 0;\nlet requestsToday = 0;\nlet lastMinuteReset = Date.now();\nlet lastDayReset = Date.now();\n// Cache for recent requests\nconst responseCache = new Map();\nasync function handler(req, res) {\n    // Only allow POST requests\n    if (req.method !== 'POST') {\n        return res.status(405).json({\n            success: false,\n            error: 'Method not allowed'\n        });\n    }\n    // Extract request parameters: either ICAO24 codes or geofence\n    const { ICAO24s, geofence } = req.body;\n    // Generate a cache key based on the request\n    let requestKey;\n    let params = new URLSearchParams();\n    let requestType = 'icao';\n    // Check if this is a geofence request\n    if (geofence && isValidGeofence(geofence)) {\n        requestType = 'geofence';\n        requestKey = `geofence-${JSON.stringify(geofence)}`;\n        // Add geofence parameters\n        params.append('lamin', geofence.lamin.toString());\n        params.append('lamax', geofence.lamax.toString());\n        params.append('lomin', geofence.lomin.toString());\n        params.append('lomax', geofence.lomax.toString());\n        console.log('[OpenSky Proxy] Geofence request:', `lat [${geofence.lamin.toFixed(4)}, ${geofence.lamax.toFixed(4)}], ` + `lng [${geofence.lomin.toFixed(4)}, ${geofence.lomax.toFixed(4)}]`);\n    } else if (Array.isArray(ICAO24s) && ICAO24s.length > 0) {\n        // Validate ICAO codes (6 hex characters)\n        const validIcaos = ICAO24s.filter((code)=>typeof code === 'string').map((code)=>code.trim().toLowerCase()).filter((code)=>/^[0-9a-f]{6}$/.test(code));\n        // Limit batch size\n        if (validIcaos.length > MAX_ICAOS_PER_REQUEST) {\n            return res.status(400).json({\n                success: false,\n                error: `Maximum ${MAX_ICAOS_PER_REQUEST} ICAO24 codes per request`\n            });\n        }\n        if (validIcaos.length === 0) {\n            return res.status(400).json({\n                success: false,\n                error: 'No valid ICAO24 codes provided'\n            });\n        }\n        requestKey = JSON.stringify(validIcaos.sort());\n        params.append('ICAO24', validIcaos.join(','));\n        params.append('extended', '1');\n    } else {\n        return res.status(400).json({\n            success: false,\n            error: 'Must provide either valid ICAO24s array or geofence parameters'\n        });\n    }\n    // Check cache for identical request\n    const cachedResponse = responseCache.get(requestKey);\n    if (cachedResponse && Date.now() - cachedResponse.timestamp < CACHE_TTL) {\n        console.log('[OpenSky Proxy] Returning cached response');\n        return res.status(200).json(cachedResponse.data);\n    }\n    // Reset rate limits if needed\n    checkAndResetRateLimits();\n    // Check rate limits\n    if (requestsThisMinute >= MAX_REQUESTS_PER_MIN) {\n        console.log('[OpenSky Proxy] Rate limit reached (per minute)');\n        return res.status(429).json({\n            success: false,\n            error: 'Rate limit exceeded',\n            retryAfter: Math.ceil((lastMinuteReset + 60000 - Date.now()) / 1000)\n        });\n    }\n    if (requestsToday >= MAX_REQUESTS_PER_DAY) {\n        console.log('[OpenSky Proxy] Rate limit reached (per day)');\n        return res.status(429).json({\n            success: false,\n            error: 'Daily limit exceeded',\n            retryAfter: Math.ceil((lastDayReset + 86400000 - Date.now()) / 1000)\n        });\n    }\n    try {\n        // Build OpenSky API URL\n        const OPENSKY_API_URL = process.env.OPENSKY_API_URL || 'https://opensky-network.org/api';\n        const endpoint = `${OPENSKY_API_URL}/states/all`;\n        if (requestType === 'geofence') {\n            console.log('[OpenSky Proxy] Fetching aircraft within geofence');\n        } else {\n            console.log(`[OpenSky Proxy] Fetching aircraft by ICAO codes`);\n        }\n        // Update rate limit counters\n        requestsThisMinute++;\n        requestsToday++;\n        // Add authentication if provided\n        const authHeaders = {};\n        if (process.env.OPENSKY_USERNAME && process.env.OPENSKY_PASSWORD) {\n            const authString = Buffer.from(`${process.env.OPENSKY_USERNAME}:${process.env.OPENSKY_PASSWORD}`).toString('base64');\n            authHeaders['Authorization'] = `Basic ${authString}`;\n        }\n        // Make request to OpenSky API with timeout\n        const controller = new AbortController();\n        const timeoutId = setTimeout(()=>controller.abort(), _config_api__WEBPACK_IMPORTED_MODULE_0__.API_CONFIG.TIMEOUT?.DEFAULT || 20000);\n        const response = await fetch(`${endpoint}?${params}`, {\n            headers: {\n                ...authHeaders,\n                Accept: 'application/json'\n            },\n            signal: controller.signal\n        });\n        clearTimeout(timeoutId);\n        if (!response.ok) {\n            throw new Error(`OpenSky API error: ${response.status} ${response.statusText}`);\n        }\n        // Parse the response\n        const data = await response.json();\n        // Extract and format aircraft states\n        // Extract and format aircraft states\n        let states = [];\n        if (data?.states && Array.isArray(data.states)) {\n            // Create a set of requested ICAO24 codes for faster lookup if this was an ICAO request\n            let requestedIcaos = null;\n            if (requestType === 'icao') {\n                requestedIcaos = new Set(ICAO24s.map((code)=>code.toLowerCase()));\n            }\n            states = data.states.filter((state)=>Array.isArray(state) && state.length >= 8 && state[5] && state[6] && // Only include aircraft that match our requested ICAO24 codes\n                (requestType === 'geofence' || state[0] && requestedIcaos?.has(state[0].toLowerCase()))).map((state)=>{\n                // OpenSky API returns an array with specific indexes\n                const [ICAO24, callsign, origin_country, time_position, last_contact, longitude, latitude, altitude, on_ground, velocity, heading, vertical_rate] = state;\n                return {\n                    ICAO24: ICAO24?.toLowerCase(),\n                    callsign: callsign?.trim(),\n                    origin_country,\n                    last_contact,\n                    longitude,\n                    latitude,\n                    altitude: altitude || 0,\n                    on_ground: !!on_ground,\n                    velocity: velocity || 0,\n                    heading: heading || 0,\n                    vertical_rate: vertical_rate || 0\n                };\n            });\n        }\n        // Prepare response\n        const responseData = {\n            success: true,\n            data: {\n                states,\n                timestamp: data.time || Date.now(),\n                meta: {\n                    total: states.length,\n                    requestType: requestType,\n                    ...requestType === 'geofence' ? {\n                        geofence\n                    } : {\n                        requested: ICAO24s.length\n                    }\n                }\n            }\n        };\n        // In your OpenSky proxy endpoint\n        console.log('[OpenSky Proxy] Raw API response:', JSON.stringify(responseData).substring(0, 500) + '...');\n        console.log('[OpenSky Proxy] Response success:', responseData.success);\n        // Cache the response\n        responseCache.set(requestKey, {\n            timestamp: Date.now(),\n            data: responseData\n        });\n        console.log(`[OpenSky Proxy] Returning ${states.length} aircraft states`);\n        return res.status(200).json(responseData);\n    } catch (error) {\n        console.error('[OpenSky Proxy] Error:', error);\n        return res.status(error instanceof Error && error.name === 'AbortError' ? 408 // Request Timeout\n         : 503 // Service Unavailable\n        ).json({\n            success: false,\n            error: error instanceof Error ? error.message : 'Failed to fetch data from OpenSky',\n            retryAfter: 60\n        });\n    }\n}\n/**\r\n * Check and reset rate limit counters if needed\r\n */ function checkAndResetRateLimits() {\n    const now = Date.now();\n    // Reset minute counter after 60 seconds\n    if (now - lastMinuteReset > 60000) {\n        requestsThisMinute = 0;\n        lastMinuteReset = now;\n        console.log('[OpenSky Proxy] Reset minute rate limit counter');\n    }\n    // Reset daily counter after 24 hours\n    if (now - lastDayReset > 86400000) {\n        requestsToday = 0;\n        lastDayReset = now;\n        console.log('[OpenSky Proxy] Reset daily rate limit counter');\n    }\n}\n/**\r\n * Validates geofence parameters\r\n */ function isValidGeofence(geofence) {\n    if (!geofence || typeof geofence !== 'object') return false;\n    // Check that all required fields exist and are numbers\n    const hasValidFields = typeof geofence.lamin === 'number' && typeof geofence.lamax === 'number' && typeof geofence.lomin === 'number' && typeof geofence.lomax === 'number';\n    if (!hasValidFields) return false;\n    // Validate ranges\n    const validLatitude = geofence.lamin >= -90 && geofence.lamin <= 90 && geofence.lamax >= -90 && geofence.lamax <= 90 && geofence.lamin <= geofence.lamax;\n    const validLongitude = geofence.lomin >= -180 && geofence.lomin <= 180 && geofence.lomax >= -180 && geofence.lomax <= 180 && geofence.lomin <= geofence.lomax;\n    return validLatitude && validLongitude;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFBVTtRQUNqQ0osZ0JBQWdCO1FBQ2hCSSxlQUFlRDtRQUNmNEIsUUFBUUMsR0FBRyxDQUFDO0lBQ2Q7QUFDRjtBQUVBOztDQUVDLEdBQ0QsU0FBU1YsZ0JBQWdCTixRQUFhO0lBQ3BDLElBQUksQ0FBQ0EsWUFBWSxPQUFPQSxhQUFhLFVBQVUsT0FBTztJQUV0RCx1REFBdUQ7SUFDdkQsTUFBTTBGLGlCQUNKLE9BQU8xRixTQUFTVSxLQUFLLEtBQUssWUFDMUIsT0FBT1YsU0FBU1ksS0FBSyxLQUFLLFlBQzFCLE9BQU9aLFNBQVNhLEtBQUssS0FBSyxZQUMxQixPQUFPYixTQUFTYyxLQUFLLEtBQUs7SUFFNUIsSUFBSSxDQUFDNEUsZ0JBQWdCLE9BQU87SUFFNUIsa0JBQWtCO0lBQ2xCLE1BQU1DLGdCQUNKM0YsU0FBU1UsS0FBSyxJQUFJLENBQUMsTUFDbkJWLFNBQVNVLEtBQUssSUFBSSxNQUNsQlYsU0FBU1ksS0FBSyxJQUFJLENBQUMsTUFDbkJaLFNBQVNZLEtBQUssSUFBSSxNQUNsQlosU0FBU1UsS0FBSyxJQUFJVixTQUFTWSxLQUFLO0lBRWxDLE1BQU1nRixpQkFDSjVGLFNBQVNhLEtBQUssSUFBSSxDQUFDLE9BQ25CYixTQUFTYSxLQUFLLElBQUksT0FDbEJiLFNBQVNjLEtBQUssSUFBSSxDQUFDLE9BQ25CZCxTQUFTYyxLQUFLLElBQUksT0FDbEJkLFNBQVNhLEtBQUssSUFBSWIsU0FBU2MsS0FBSztJQUVsQyxPQUFPNkUsaUJBQWlCQztBQUMxQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxzYXRob1xcRG9jdW1lbnRzXFxQcm9qZWN0c1xcYWlyY3JhZnQtdHJhY2tpbmdcXHBhZ2VzXFxhcGlcXHByb3h5XFxvcGVuc2t5LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHBhZ2VzL2FwaS9wcm94eS9vcGVuc2t5LnRzXHJcbmltcG9ydCB0eXBlIHsgTmV4dEFwaVJlcXVlc3QsIE5leHRBcGlSZXNwb25zZSB9IGZyb20gJ25leHQnO1xyXG5pbXBvcnQgeyBBUElfQ09ORklHIH0gZnJvbSAnQC9jb25maWcvYXBpJztcclxuXHJcbi8vIENvbnN0YW50c1xyXG5jb25zdCBNQVhfSUNBT1NfUEVSX1JFUVVFU1QgPSAxMDA7IC8vIE9wZW5Ta3kgbGltaXRcclxuY29uc3QgQ0FDSEVfVFRMID0gNjAwMDA7IC8vIDEgbWludXRlIGNhY2hlXHJcbmNvbnN0IE1BWF9SRVFVRVNUU19QRVJfTUlOID0gMTU7IC8vIFJhdGUgbGltaXRcclxuY29uc3QgTUFYX1JFUVVFU1RTX1BFUl9EQVkgPSAxMDAwOyAvLyBEYWlseSBsaW1pdFxyXG5cclxuLy8gUmF0ZSBsaW1pdGluZyBzdGF0ZVxyXG5sZXQgcmVxdWVzdHNUaGlzTWludXRlID0gMDtcclxubGV0IHJlcXVlc3RzVG9kYXkgPSAwO1xyXG5sZXQgbGFzdE1pbnV0ZVJlc2V0ID0gRGF0ZS5ub3coKTtcclxubGV0IGxhc3REYXlSZXNldCA9IERhdGUubm93KCk7XHJcblxyXG4vLyBDYWNoZSBmb3IgcmVjZW50IHJlcXVlc3RzXHJcbmNvbnN0IHJlc3BvbnNlQ2FjaGUgPSBuZXcgTWFwPHN0cmluZywgeyB0aW1lc3RhbXA6IG51bWJlcjsgZGF0YTogYW55IH0+KCk7XHJcblxyXG4vLyBHZW9mZW5jZSBwYXJhbWV0ZXIgdmFsaWRhdGlvblxyXG5pbnRlcmZhY2UgR2VvZmVuY2VQYXJhbXMge1xyXG4gIGxhbWluOiBudW1iZXI7IC8vIExvd2VyIGxhdGl0dWRlIGJvdW5kIChzb3V0aGVybiBib3JkZXIpXHJcbiAgbGFtYXg6IG51bWJlcjsgLy8gVXBwZXIgbGF0aXR1ZGUgYm91bmQgKG5vcnRoZXJuIGJvcmRlcilcclxuICBsb21pbjogbnVtYmVyOyAvLyBMb3dlciBsb25naXR1ZGUgYm91bmQgKHdlc3Rlcm4gYm9yZGVyKVxyXG4gIGxvbWF4OiBudW1iZXI7IC8vIFVwcGVyIGxvbmdpdHVkZSBib3VuZCAoZWFzdGVybiBib3JkZXIpXHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXHJcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcclxuICByZXM6IE5leHRBcGlSZXNwb25zZVxyXG4pIHtcclxuICAvLyBPbmx5IGFsbG93IFBPU1QgcmVxdWVzdHNcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBFeHRyYWN0IHJlcXVlc3QgcGFyYW1ldGVyczogZWl0aGVyIElDQU8yNCBjb2RlcyBvciBnZW9mZW5jZVxyXG4gIGNvbnN0IHsgSUNBTzI0cywgZ2VvZmVuY2UgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAvLyBHZW5lcmF0ZSBhIGNhY2hlIGtleSBiYXNlZCBvbiB0aGUgcmVxdWVzdFxyXG4gIGxldCByZXF1ZXN0S2V5OiBzdHJpbmc7XHJcbiAgbGV0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICBsZXQgcmVxdWVzdFR5cGU6ICdpY2FvJyB8ICdnZW9mZW5jZScgPSAnaWNhbyc7XHJcblxyXG4gIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBnZW9mZW5jZSByZXF1ZXN0XHJcbiAgaWYgKGdlb2ZlbmNlICYmIGlzVmFsaWRHZW9mZW5jZShnZW9mZW5jZSkpIHtcclxuICAgIHJlcXVlc3RUeXBlID0gJ2dlb2ZlbmNlJztcclxuICAgIHJlcXVlc3RLZXkgPSBgZ2VvZmVuY2UtJHtKU09OLnN0cmluZ2lmeShnZW9mZW5jZSl9YDtcclxuXHJcbiAgICAvLyBBZGQgZ2VvZmVuY2UgcGFyYW1ldGVyc1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnbGFtaW4nLCBnZW9mZW5jZS5sYW1pbi50b1N0cmluZygpKTtcclxuICAgIHBhcmFtcy5hcHBlbmQoJ2xhbWF4JywgZ2VvZmVuY2UubGFtYXgudG9TdHJpbmcoKSk7XHJcbiAgICBwYXJhbXMuYXBwZW5kKCdsb21pbicsIGdlb2ZlbmNlLmxvbWluLnRvU3RyaW5nKCkpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnbG9tYXgnLCBnZW9mZW5jZS5sb21heC50b1N0cmluZygpKTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhcclxuICAgICAgJ1tPcGVuU2t5IFByb3h5XSBHZW9mZW5jZSByZXF1ZXN0OicsXHJcbiAgICAgIGBsYXQgWyR7Z2VvZmVuY2UubGFtaW4udG9GaXhlZCg0KX0sICR7Z2VvZmVuY2UubGFtYXgudG9GaXhlZCg0KX1dLCBgICtcclxuICAgICAgICBgbG5nIFske2dlb2ZlbmNlLmxvbWluLnRvRml4ZWQoNCl9LCAke2dlb2ZlbmNlLmxvbWF4LnRvRml4ZWQoNCl9XWBcclxuICAgICk7XHJcbiAgfVxyXG4gIC8vIE90aGVyd2lzZSwgcHJvY2VzcyBhcyBJQ0FPMjQgcmVxdWVzdCAoZXhpc3RpbmcgbG9naWMpXHJcbiAgZWxzZSBpZiAoQXJyYXkuaXNBcnJheShJQ0FPMjRzKSAmJiBJQ0FPMjRzLmxlbmd0aCA+IDApIHtcclxuICAgIC8vIFZhbGlkYXRlIElDQU8gY29kZXMgKDYgaGV4IGNoYXJhY3RlcnMpXHJcbiAgICBjb25zdCB2YWxpZEljYW9zID0gSUNBTzI0cy5maWx0ZXIoKGNvZGUpID0+IHR5cGVvZiBjb2RlID09PSAnc3RyaW5nJylcclxuICAgICAgLm1hcCgoY29kZSkgPT4gY29kZS50cmltKCkudG9Mb3dlckNhc2UoKSlcclxuICAgICAgLmZpbHRlcigoY29kZSkgPT4gL15bMC05YS1mXXs2fSQvLnRlc3QoY29kZSkpO1xyXG5cclxuICAgIC8vIExpbWl0IGJhdGNoIHNpemVcclxuICAgIGlmICh2YWxpZEljYW9zLmxlbmd0aCA+IE1BWF9JQ0FPU19QRVJfUkVRVUVTVCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICAgIGVycm9yOiBgTWF4aW11bSAke01BWF9JQ0FPU19QRVJfUkVRVUVTVH0gSUNBTzI0IGNvZGVzIHBlciByZXF1ZXN0YCxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHZhbGlkSWNhb3MubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdObyB2YWxpZCBJQ0FPMjQgY29kZXMgcHJvdmlkZWQnLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0S2V5ID0gSlNPTi5zdHJpbmdpZnkodmFsaWRJY2Fvcy5zb3J0KCkpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnSUNBTzI0JywgdmFsaWRJY2Fvcy5qb2luKCcsJykpO1xyXG4gICAgcGFyYW1zLmFwcGVuZCgnZXh0ZW5kZWQnLCAnMScpO1xyXG4gIH1cclxuICAvLyBJbnZhbGlkIHJlcXVlc3QgLSBtaXNzaW5nIGJvdGggSUNBTzI0IGNvZGVzIGFuZCBnZW9mZW5jZVxyXG4gIGVsc2Uge1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnTXVzdCBwcm92aWRlIGVpdGhlciB2YWxpZCBJQ0FPMjRzIGFycmF5IG9yIGdlb2ZlbmNlIHBhcmFtZXRlcnMnLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBDaGVjayBjYWNoZSBmb3IgaWRlbnRpY2FsIHJlcXVlc3RcclxuICBjb25zdCBjYWNoZWRSZXNwb25zZSA9IHJlc3BvbnNlQ2FjaGUuZ2V0KHJlcXVlc3RLZXkpO1xyXG5cclxuICBpZiAoY2FjaGVkUmVzcG9uc2UgJiYgRGF0ZS5ub3coKSAtIGNhY2hlZFJlc3BvbnNlLnRpbWVzdGFtcCA8IENBQ0hFX1RUTCkge1xyXG4gICAgY29uc29sZS5sb2coJ1tPcGVuU2t5IFByb3h5XSBSZXR1cm5pbmcgY2FjaGVkIHJlc3BvbnNlJyk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oY2FjaGVkUmVzcG9uc2UuZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvLyBSZXNldCByYXRlIGxpbWl0cyBpZiBuZWVkZWRcclxuICBjaGVja0FuZFJlc2V0UmF0ZUxpbWl0cygpO1xyXG5cclxuICAvLyBDaGVjayByYXRlIGxpbWl0c1xyXG4gIGlmIChyZXF1ZXN0c1RoaXNNaW51dGUgPj0gTUFYX1JFUVVFU1RTX1BFUl9NSU4pIHtcclxuICAgIGNvbnNvbGUubG9nKCdbT3BlblNreSBQcm94eV0gUmF0ZSBsaW1pdCByZWFjaGVkIChwZXIgbWludXRlKScpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDI5KS5qc29uKHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiAnUmF0ZSBsaW1pdCBleGNlZWRlZCcsXHJcbiAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbCgobGFzdE1pbnV0ZVJlc2V0ICsgNjAwMDAgLSBEYXRlLm5vdygpKSAvIDEwMDApLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBpZiAocmVxdWVzdHNUb2RheSA+PSBNQVhfUkVRVUVTVFNfUEVSX0RBWSkge1xyXG4gICAgY29uc29sZS5sb2coJ1tPcGVuU2t5IFByb3h5XSBSYXRlIGxpbWl0IHJlYWNoZWQgKHBlciBkYXkpJyk7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MjkpLmpzb24oe1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6ICdEYWlseSBsaW1pdCBleGNlZWRlZCcsXHJcbiAgICAgIHJldHJ5QWZ0ZXI6IE1hdGguY2VpbCgobGFzdERheVJlc2V0ICsgODY0MDAwMDAgLSBEYXRlLm5vdygpKSAvIDEwMDApLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8gQnVpbGQgT3BlblNreSBBUEkgVVJMXHJcbiAgICBjb25zdCBPUEVOU0tZX0FQSV9VUkwgPVxyXG4gICAgICBwcm9jZXNzLmVudi5PUEVOU0tZX0FQSV9VUkwgfHwgJ2h0dHBzOi8vb3BlbnNreS1uZXR3b3JrLm9yZy9hcGknO1xyXG4gICAgY29uc3QgZW5kcG9pbnQgPSBgJHtPUEVOU0tZX0FQSV9VUkx9L3N0YXRlcy9hbGxgO1xyXG5cclxuICAgIGlmIChyZXF1ZXN0VHlwZSA9PT0gJ2dlb2ZlbmNlJykge1xyXG4gICAgICBjb25zb2xlLmxvZygnW09wZW5Ta3kgUHJveHldIEZldGNoaW5nIGFpcmNyYWZ0IHdpdGhpbiBnZW9mZW5jZScpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5sb2coYFtPcGVuU2t5IFByb3h5XSBGZXRjaGluZyBhaXJjcmFmdCBieSBJQ0FPIGNvZGVzYCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIHJhdGUgbGltaXQgY291bnRlcnNcclxuICAgIHJlcXVlc3RzVGhpc01pbnV0ZSsrO1xyXG4gICAgcmVxdWVzdHNUb2RheSsrO1xyXG5cclxuICAgIC8vIEFkZCBhdXRoZW50aWNhdGlvbiBpZiBwcm92aWRlZFxyXG4gICAgY29uc3QgYXV0aEhlYWRlcnM6IEhlYWRlcnNJbml0ID0ge307XHJcbiAgICBpZiAocHJvY2Vzcy5lbnYuT1BFTlNLWV9VU0VSTkFNRSAmJiBwcm9jZXNzLmVudi5PUEVOU0tZX1BBU1NXT1JEKSB7XHJcbiAgICAgIGNvbnN0IGF1dGhTdHJpbmcgPSBCdWZmZXIuZnJvbShcclxuICAgICAgICBgJHtwcm9jZXNzLmVudi5PUEVOU0tZX1VTRVJOQU1FfToke3Byb2Nlc3MuZW52Lk9QRU5TS1lfUEFTU1dPUkR9YFxyXG4gICAgICApLnRvU3RyaW5nKCdiYXNlNjQnKTtcclxuICAgICAgYXV0aEhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSA9IGBCYXNpYyAke2F1dGhTdHJpbmd9YDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYWtlIHJlcXVlc3QgdG8gT3BlblNreSBBUEkgd2l0aCB0aW1lb3V0XHJcbiAgICBjb25zdCBjb250cm9sbGVyID0gbmV3IEFib3J0Q29udHJvbGxlcigpO1xyXG4gICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dChcclxuICAgICAgKCkgPT4gY29udHJvbGxlci5hYm9ydCgpLFxyXG4gICAgICBBUElfQ09ORklHLlRJTUVPVVQ/LkRFRkFVTFQgfHwgMjAwMDBcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtlbmRwb2ludH0/JHtwYXJhbXN9YCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgLi4uYXV0aEhlYWRlcnMsXHJcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICAgIHNpZ25hbDogY29udHJvbGxlci5zaWduYWwsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgT3BlblNreSBBUEkgZXJyb3I6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YFxyXG4gICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBhcnNlIHRoZSByZXNwb25zZVxyXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuXHJcbiAgICAvLyBFeHRyYWN0IGFuZCBmb3JtYXQgYWlyY3JhZnQgc3RhdGVzXHJcbiAgICAvLyBFeHRyYWN0IGFuZCBmb3JtYXQgYWlyY3JhZnQgc3RhdGVzXHJcbiAgICBsZXQgc3RhdGVzID0gW107XHJcbiAgICBpZiAoZGF0YT8uc3RhdGVzICYmIEFycmF5LmlzQXJyYXkoZGF0YS5zdGF0ZXMpKSB7XHJcbiAgICAgIC8vIENyZWF0ZSBhIHNldCBvZiByZXF1ZXN0ZWQgSUNBTzI0IGNvZGVzIGZvciBmYXN0ZXIgbG9va3VwIGlmIHRoaXMgd2FzIGFuIElDQU8gcmVxdWVzdFxyXG4gICAgICBsZXQgcmVxdWVzdGVkSWNhb3M6IFNldDxzdHJpbmc+IHwgbnVsbCA9IG51bGw7XHJcbiAgICAgIGlmIChyZXF1ZXN0VHlwZSA9PT0gJ2ljYW8nKSB7XHJcbiAgICAgICAgcmVxdWVzdGVkSWNhb3MgPSBuZXcgU2V0KFxyXG4gICAgICAgICAgKElDQU8yNHMgYXMgc3RyaW5nW10pLm1hcCgoY29kZSkgPT4gY29kZS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHN0YXRlcyA9IGRhdGEuc3RhdGVzXHJcbiAgICAgICAgLmZpbHRlcihcclxuICAgICAgICAgIChzdGF0ZTogYW55W10pID0+XHJcbiAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoc3RhdGUpICYmXHJcbiAgICAgICAgICAgIHN0YXRlLmxlbmd0aCA+PSA4ICYmXHJcbiAgICAgICAgICAgIHN0YXRlWzVdICYmXHJcbiAgICAgICAgICAgIHN0YXRlWzZdICYmXHJcbiAgICAgICAgICAgIC8vIE9ubHkgaW5jbHVkZSBhaXJjcmFmdCB0aGF0IG1hdGNoIG91ciByZXF1ZXN0ZWQgSUNBTzI0IGNvZGVzXHJcbiAgICAgICAgICAgIChyZXF1ZXN0VHlwZSA9PT0gJ2dlb2ZlbmNlJyB8fFxyXG4gICAgICAgICAgICAgIChzdGF0ZVswXSAmJiByZXF1ZXN0ZWRJY2Fvcz8uaGFzKHN0YXRlWzBdLnRvTG93ZXJDYXNlKCkpKSlcclxuICAgICAgICApXHJcbiAgICAgICAgLm1hcCgoc3RhdGU6IGFueVtdKSA9PiB7XHJcbiAgICAgICAgICAvLyBPcGVuU2t5IEFQSSByZXR1cm5zIGFuIGFycmF5IHdpdGggc3BlY2lmaWMgaW5kZXhlc1xyXG4gICAgICAgICAgY29uc3QgW1xyXG4gICAgICAgICAgICBJQ0FPMjQsXHJcbiAgICAgICAgICAgIGNhbGxzaWduLFxyXG4gICAgICAgICAgICBvcmlnaW5fY291bnRyeSxcclxuICAgICAgICAgICAgdGltZV9wb3NpdGlvbixcclxuICAgICAgICAgICAgbGFzdF9jb250YWN0LFxyXG4gICAgICAgICAgICBsb25naXR1ZGUsXHJcbiAgICAgICAgICAgIGxhdGl0dWRlLFxyXG4gICAgICAgICAgICBhbHRpdHVkZSxcclxuICAgICAgICAgICAgb25fZ3JvdW5kLFxyXG4gICAgICAgICAgICB2ZWxvY2l0eSxcclxuICAgICAgICAgICAgaGVhZGluZyxcclxuICAgICAgICAgICAgdmVydGljYWxfcmF0ZSxcclxuICAgICAgICAgICAgLy8gLi4uIG90aGVyIGZpZWxkc1xyXG4gICAgICAgICAgXSA9IHN0YXRlO1xyXG5cclxuICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIElDQU8yNDogSUNBTzI0Py50b0xvd2VyQ2FzZSgpLFxyXG4gICAgICAgICAgICBjYWxsc2lnbjogY2FsbHNpZ24/LnRyaW0oKSxcclxuICAgICAgICAgICAgb3JpZ2luX2NvdW50cnksXHJcbiAgICAgICAgICAgIGxhc3RfY29udGFjdCxcclxuICAgICAgICAgICAgbG9uZ2l0dWRlLFxyXG4gICAgICAgICAgICBsYXRpdHVkZSxcclxuICAgICAgICAgICAgYWx0aXR1ZGU6IGFsdGl0dWRlIHx8IDAsXHJcbiAgICAgICAgICAgIG9uX2dyb3VuZDogISFvbl9ncm91bmQsXHJcbiAgICAgICAgICAgIHZlbG9jaXR5OiB2ZWxvY2l0eSB8fCAwLFxyXG4gICAgICAgICAgICBoZWFkaW5nOiBoZWFkaW5nIHx8IDAsXHJcbiAgICAgICAgICAgIHZlcnRpY2FsX3JhdGU6IHZlcnRpY2FsX3JhdGUgfHwgMCxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gUHJlcGFyZSByZXNwb25zZVxyXG4gICAgY29uc3QgcmVzcG9uc2VEYXRhID0ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBkYXRhOiB7XHJcbiAgICAgICAgc3RhdGVzLFxyXG4gICAgICAgIHRpbWVzdGFtcDogZGF0YS50aW1lIHx8IERhdGUubm93KCksXHJcbiAgICAgICAgbWV0YToge1xyXG4gICAgICAgICAgdG90YWw6IHN0YXRlcy5sZW5ndGgsXHJcbiAgICAgICAgICByZXF1ZXN0VHlwZTogcmVxdWVzdFR5cGUsXHJcbiAgICAgICAgICAuLi4ocmVxdWVzdFR5cGUgPT09ICdnZW9mZW5jZSdcclxuICAgICAgICAgICAgPyB7IGdlb2ZlbmNlIH1cclxuICAgICAgICAgICAgOiB7IHJlcXVlc3RlZDogKElDQU8yNHMgYXMgc3RyaW5nW10pLmxlbmd0aCB9KSxcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJbiB5b3VyIE9wZW5Ta3kgcHJveHkgZW5kcG9pbnRcclxuICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAnW09wZW5Ta3kgUHJveHldIFJhdyBBUEkgcmVzcG9uc2U6JyxcclxuICAgICAgSlNPTi5zdHJpbmdpZnkocmVzcG9uc2VEYXRhKS5zdWJzdHJpbmcoMCwgNTAwKSArICcuLi4nXHJcbiAgICApO1xyXG4gICAgY29uc29sZS5sb2coJ1tPcGVuU2t5IFByb3h5XSBSZXNwb25zZSBzdWNjZXNzOicsIHJlc3BvbnNlRGF0YS5zdWNjZXNzKTtcclxuXHJcbiAgICAvLyBDYWNoZSB0aGUgcmVzcG9uc2VcclxuICAgIHJlc3BvbnNlQ2FjaGUuc2V0KHJlcXVlc3RLZXksIHtcclxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxyXG4gICAgICBkYXRhOiByZXNwb25zZURhdGEsXHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgW09wZW5Ta3kgUHJveHldIFJldHVybmluZyAke3N0YXRlcy5sZW5ndGh9IGFpcmNyYWZ0IHN0YXRlc2ApO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3BvbnNlRGF0YSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ1tPcGVuU2t5IFByb3h5XSBFcnJvcjonLCBlcnJvcik7XHJcblxyXG4gICAgcmV0dXJuIHJlc1xyXG4gICAgICAuc3RhdHVzKFxyXG4gICAgICAgIGVycm9yIGluc3RhbmNlb2YgRXJyb3IgJiYgZXJyb3IubmFtZSA9PT0gJ0Fib3J0RXJyb3InXHJcbiAgICAgICAgICA/IDQwOCAvLyBSZXF1ZXN0IFRpbWVvdXRcclxuICAgICAgICAgIDogNTAzIC8vIFNlcnZpY2UgVW5hdmFpbGFibGVcclxuICAgICAgKVxyXG4gICAgICAuanNvbih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6XHJcbiAgICAgICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yXHJcbiAgICAgICAgICAgID8gZXJyb3IubWVzc2FnZVxyXG4gICAgICAgICAgICA6ICdGYWlsZWQgdG8gZmV0Y2ggZGF0YSBmcm9tIE9wZW5Ta3knLFxyXG4gICAgICAgIHJldHJ5QWZ0ZXI6IDYwLFxyXG4gICAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDaGVjayBhbmQgcmVzZXQgcmF0ZSBsaW1pdCBjb3VudGVycyBpZiBuZWVkZWRcclxuICovXHJcbmZ1bmN0aW9uIGNoZWNrQW5kUmVzZXRSYXRlTGltaXRzKCkge1xyXG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gIC8vIFJlc2V0IG1pbnV0ZSBjb3VudGVyIGFmdGVyIDYwIHNlY29uZHNcclxuICBpZiAobm93IC0gbGFzdE1pbnV0ZVJlc2V0ID4gNjAwMDApIHtcclxuICAgIHJlcXVlc3RzVGhpc01pbnV0ZSA9IDA7XHJcbiAgICBsYXN0TWludXRlUmVzZXQgPSBub3c7XHJcbiAgICBjb25zb2xlLmxvZygnW09wZW5Ta3kgUHJveHldIFJlc2V0IG1pbnV0ZSByYXRlIGxpbWl0IGNvdW50ZXInKTtcclxuICB9XHJcblxyXG4gIC8vIFJlc2V0IGRhaWx5IGNvdW50ZXIgYWZ0ZXIgMjQgaG91cnNcclxuICBpZiAobm93IC0gbGFzdERheVJlc2V0ID4gODY0MDAwMDApIHtcclxuICAgIHJlcXVlc3RzVG9kYXkgPSAwO1xyXG4gICAgbGFzdERheVJlc2V0ID0gbm93O1xyXG4gICAgY29uc29sZS5sb2coJ1tPcGVuU2t5IFByb3h5XSBSZXNldCBkYWlseSByYXRlIGxpbWl0IGNvdW50ZXInKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBWYWxpZGF0ZXMgZ2VvZmVuY2UgcGFyYW1ldGVyc1xyXG4gKi9cclxuZnVuY3Rpb24gaXNWYWxpZEdlb2ZlbmNlKGdlb2ZlbmNlOiBhbnkpOiBnZW9mZW5jZSBpcyBHZW9mZW5jZVBhcmFtcyB7XHJcbiAgaWYgKCFnZW9mZW5jZSB8fCB0eXBlb2YgZ2VvZmVuY2UgIT09ICdvYmplY3QnKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gIC8vIENoZWNrIHRoYXQgYWxsIHJlcXVpcmVkIGZpZWxkcyBleGlzdCBhbmQgYXJlIG51bWJlcnNcclxuICBjb25zdCBoYXNWYWxpZEZpZWxkcyA9XHJcbiAgICB0eXBlb2YgZ2VvZmVuY2UubGFtaW4gPT09ICdudW1iZXInICYmXHJcbiAgICB0eXBlb2YgZ2VvZmVuY2UubGFtYXggPT09ICdudW1iZXInICYmXHJcbiAgICB0eXBlb2YgZ2VvZmVuY2UubG9taW4gPT09ICdudW1iZXInICYmXHJcbiAgICB0eXBlb2YgZ2VvZmVuY2UubG9tYXggPT09ICdudW1iZXInO1xyXG5cclxuICBpZiAoIWhhc1ZhbGlkRmllbGRzKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gIC8vIFZhbGlkYXRlIHJhbmdlc1xyXG4gIGNvbnN0IHZhbGlkTGF0aXR1ZGUgPVxyXG4gICAgZ2VvZmVuY2UubGFtaW4gPj0gLTkwICYmXHJcbiAgICBnZW9mZW5jZS5sYW1pbiA8PSA5MCAmJlxyXG4gICAgZ2VvZmVuY2UubGFtYXggPj0gLTkwICYmXHJcbiAgICBnZW9mZW5jZS5sYW1heCA8PSA5MCAmJlxyXG4gICAgZ2VvZmVuY2UubGFtaW4gPD0gZ2VvZmVuY2UubGFtYXg7XHJcblxyXG4gIGNvbnN0IHZhbGlkTG9uZ2l0dWRlID1cclxuICAgIGdlb2ZlbmNlLmxvbWluID49IC0xODAgJiZcclxuICAgIGdlb2ZlbmNlLmxvbWluIDw9IDE4MCAmJlxyXG4gICAgZ2VvZmVuY2UubG9tYXggPj0gLTE4MCAmJlxyXG4gICAgZ2VvZmVuY2UubG9tYXggPD0gMTgwICYmXHJcbiAgICBnZW9mZW5jZS5sb21pbiA8PSBnZW9mZW5jZS5sb21heDtcclxuXHJcbiAgcmV0dXJuIHZhbGlkTGF0aXR1ZGUgJiYgdmFsaWRMb25naXR1ZGU7XHJcbn1cclxuIl0sIm5hbWVzIjpbIkFQSV9DT05GSUciLCJNQVhfSUNBT1NfUEVSX1JFUVVFU1QiLCJDQUNIRV9UVEwiLCJNQVhfUkVRVUVTVFNfUEVSX01JTiIsIk1BWF9SRVFVRVNUU19QRVJfREFZIiwicmVxdWVzdHNUaGlzTWludXRlIiwicmVxdWVzdHNUb2RheSIsImxhc3RNaW51dGVSZXNldCIsIkRhdGUiLCJub3ciLCJsYXN0RGF5UmVzZXQiLCJyZXNwb25zZUNhY2hlIiwiTWFwIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsInN0YXR1cyIsImpzb24iLCJzdWNjZXNzIiwiZXJyb3IiLCJJQ0FPMjRzIiwiZ2VvZmVuY2UiLCJib2R5IiwicmVxdWVzdEtleSIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsInJlcXVlc3RUeXBlIiwiaXNWYWxpZEdlb2ZlbmNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImFwcGVuZCIsImxhbWluIiwidG9TdHJpbmciLCJsYW1heCIsImxvbWluIiwibG9tYXgiLCJjb25zb2xlIiwibG9nIiwidG9GaXhlZCIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsInZhbGlkSWNhb3MiLCJmaWx0ZXIiLCJjb2RlIiwibWFwIiwidHJpbSIsInRvTG93ZXJDYXNlIiwidGVzdCIsInNvcnQiLCJqb2luIiwiY2FjaGVkUmVzcG9uc2UiLCJnZXQiLCJ0aW1lc3RhbXAiLCJkYXRhIiwiY2hlY2tBbmRSZXNldFJhdGVMaW1pdHMiLCJyZXRyeUFmdGVyIiwiTWF0aCIsImNlaWwiLCJPUEVOU0tZX0FQSV9VUkwiLCJwcm9jZXNzIiwiZW52IiwiZW5kcG9pbnQiLCJhdXRoSGVhZGVycyIsIk9QRU5TS1lfVVNFUk5BTUUiLCJPUEVOU0tZX1BBU1NXT1JEIiwiYXV0aFN0cmluZyIsIkJ1ZmZlciIsImZyb20iLCJjb250cm9sbGVyIiwiQWJvcnRDb250cm9sbGVyIiwidGltZW91dElkIiwic2V0VGltZW91dCIsImFib3J0IiwiVElNRU9VVCIsIkRFRkFVTFQiLCJyZXNwb25zZSIsImZldGNoIiwiaGVhZGVycyIsIkFjY2VwdCIsInNpZ25hbCIsImNsZWFyVGltZW91dCIsIm9rIiwiRXJyb3IiLCJzdGF0dXNUZXh0Iiwic3RhdGVzIiwicmVxdWVzdGVkSWNhb3MiLCJTZXQiLCJzdGF0ZSIsImhhcyIsIklDQU8yNCIsImNhbGxzaWduIiwib3JpZ2luX2NvdW50cnkiLCJ0aW1lX3Bvc2l0aW9uIiwibGFzdF9jb250YWN0IiwibG9uZ2l0dWRlIiwibGF0aXR1ZGUiLCJhbHRpdHVkZSIsIm9uX2dyb3VuZCIsInZlbG9jaXR5IiwiaGVhZGluZyIsInZlcnRpY2FsX3JhdGUiLCJyZXNwb25zZURhdGEiLCJ0aW1lIiwibWV0YSIsInRvdGFsIiwicmVxdWVzdGVkIiwic3Vic3RyaW5nIiwic2V0IiwibmFtZSIsIm1lc3NhZ2UiLCJoYXNWYWxpZEZpZWxkcyIsInZhbGlkTGF0aXR1ZGUiLCJ2YWxpZExvbmdpdHVkZSJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api-node)/./pages/api/proxy/opensky.ts\n");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api-node)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fproxy%2Fopensky&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cproxy%5Copensky.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();